@inject IJSRuntime JSRuntime

<div class="video-container">
    <video-js id="@_playerId" class="video-js" controls preload="auto">
        <source src="@Source" type="application/x-mpegURL" />
    </video-js>
</div>

<style>
    html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
    }
    
    .video-container {
        width: 100%;
        height: 100vh;
        overflow: hidden;
        position: relative;
    }

    .video-container .video-js {
        width: 100%;
        height: 100%;
        position: relative;
    }

    .video-container .vjs-tech {
        position: absolute;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        object-fit: cover;
        object-position: center;
    }

    .video-container .vjs-control-bar {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        z-index: 2;
        background: rgba(0,0,0,0.7);
    }

    .video-js .vjs-menu {
        right: 0 !important;
        left: auto !important;
        overflow: visible !important;
    }

    .video-js .vjs-big-play-button {
        z-index: 2;
    }
</style>

@code {
    private readonly string _playerId = $"player-{Guid.NewGuid():N}";

    [Parameter]
    public string Source { get; set; } = "";

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try
            {
                await JSRuntime.InvokeVoidAsync("initializePlayer", _playerId);
            }
            catch (Exception ex)
            {
                await JSRuntime.InvokeVoidAsync("console.error", "Error initializing video player:", ex.Message);
            }
        }
    }
} 